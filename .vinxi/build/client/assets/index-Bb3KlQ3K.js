import{a as U,r as x,V as N,o as q,j as e,s as b,n as _,e as $}from"./index-BzBvWqhX.js";import{L as f,C as J,P as M}from"./Layout-DHUNYKTw.js";import{u as z}from"./auth-DP1CS8M1.js";import{e as B,u as o,a as G,b as H,C as Y}from"./zod-_sgmqnks.js";import{D as K,F as W,a as X}from"./file-text-5vL03K5q.js";/**
 * @license lucide-react v0.532.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],ee=B("activity",Z),se=q({exportType:$(["expenses","events","sessions","products","registrations"]),eventId:_().optional(),startDate:b().optional(),endDate:b().optional()}),xe=function(){const{token:n,user:v}=z(),d=U(),[ae,re]=x.useState("expenses"),[l,w]=x.useState(null),[h,m]=x.useState(null),u=o(d.getEvents.queryOptions({authToken:n})),c=o(d.getExpenses.queryOptions({authToken:n})),E=o(d.getSessions.queryOptions({authToken:n})),T=o(d.getProducts.queryOptions({authToken:n})),t=o({...d.exportToExcel.queryOptions({authToken:n,...h}),enabled:h!==null});x.useEffect(()=>{if(t.isSuccess&&t.data){const s=t.data;w(s);const a=[s.headers.join(","),...s.data.map(I=>I.map(Q=>`"${Q}"`).join(","))].join(`
`),p=new Blob([a],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a"),F=URL.createObjectURL(p);r.setAttribute("href",F),r.setAttribute("download",`${s.exportType}_export_${new Date().toISOString().split("T")[0]}.csv`),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r),N.success("Export completed successfully"),m(null)}t.isError&&(N.error(t.error?.message||"Export failed"),m(null))},[t.isSuccess,t.isError,t.data,t.error]);const{register:i,handleSubmit:D,formState:{errors:g},watch:le}=G({resolver:H(se),defaultValues:{exportType:"expenses"}});if(v?.role!=="ADMIN")return e.jsx(f,{children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-red-600",children:"Access Denied"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"You don't have permission to access this page."})]})});const S=async s=>{try{m(s)}catch{}},k=u.data?.length||0,A=E.data?.length||0,P=T.data?.length||0,C=c.data?.reduce((s,a)=>a.status==="APPROVED"?s+a.amount:s,0)||0,R=c.data?.filter(s=>s.status==="PENDING").length||0,O=c.data?.filter(s=>s.status==="APPROVED").length||0,L=c.data?.filter(s=>s.status==="REJECTED").length||0,j=c.data?.slice(0,5)||[],y=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(s),V=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return e.jsx(f,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Reporting & Analytics"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(J,{className:"h-5 w-5 text-red-600 mr-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Admin Dashboard"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Y,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Events"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:k})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ee,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Sessions"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:A})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(M,{className:"h-8 w-8 text-purple-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Products"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:P})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(K,{className:"h-8 w-8 text-red-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Expenses"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:y(C)})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Expense Status Overview"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-yellow-50 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:R}),e.jsx("p",{className:"text-sm text-yellow-800",children:"Pending Approval"})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:O}),e.jsx("p",{className:"text-sm text-green-800",children:"Approved"})]}),e.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-red-600",children:L}),e.jsx("p",{className:"text-sm text-red-800",children:"Rejected"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Recent Expense Activity"}),j.length>0?e.jsx("div",{className:"space-y-3",children:j.map(s=>e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-100 last:border-b-0",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(W,{className:"h-4 w-4 text-gray-400 mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.expenseType}),e.jsxs("p",{className:"text-xs text-gray-500",children:[s.vendor," â€¢ ",V(s.createdAt)]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:y(s.amount)}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${s.status==="APPROVED"?"bg-green-100 text-green-800":s.status==="REJECTED"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:s.status})]})]},s.id))}):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No recent expenses"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Data Export"}),e.jsxs("form",{onSubmit:D(S),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Export Type *"}),e.jsxs("select",{...i("exportType"),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-red-500 focus:border-red-500",children:[e.jsx("option",{value:"expenses",children:"Expenses"}),e.jsx("option",{value:"events",children:"Events"}),e.jsx("option",{value:"sessions",children:"Sessions"}),e.jsx("option",{value:"products",children:"Products"}),e.jsx("option",{value:"registrations",children:"Registrations"})]}),g.exportType&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:g.exportType.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Filter by Event"}),e.jsxs("select",{...i("eventId",{valueAsNumber:!0}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-red-500 focus:border-red-500",children:[e.jsx("option",{value:"",children:"All Events"}),u.data?.map(s=>e.jsx("option",{value:s.id,children:s.eventName},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Start Date"}),e.jsx("input",{...i("startDate"),type:"date",className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-red-500 focus:border-red-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"End Date"}),e.jsx("input",{...i("endDate"),type:"date",className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-red-500 focus:border-red-500"})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{type:"submit",disabled:t.isLoading,className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-md flex items-center disabled:opacity-50",children:[e.jsx(X,{className:"h-4 w-4 mr-2"}),t.isLoading?"Exporting...":"Export to CSV"]})})]})]}),l&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"text-lg font-medium text-gray-900",children:["Exported Data - ",l.exportType.charAt(0).toUpperCase()+l.exportType.slice(1)]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Exported on: ",new Date(l.timestamp).toLocaleString()]})]}),l.data.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsx("tr",{children:l.headers.map((s,a)=>e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:s},a))})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.data.map((s,a)=>e.jsx("tr",{className:a%2===0?"bg-white":"bg-gray-50",children:s.map((p,r)=>e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:p},r))},a))})]})}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"No data found for the selected criteria."})})]})]})})};export{xe as component};
