import{a as je,r as n,V as g,o as L,j as e,b as Ne,e as J,n as b,s as v}from"./index-BzBvWqhX.js";import{L as B,M as ve,P as we,X as H}from"./Layout-DHUNYKTw.js";import{u as Ee}from"./auth-DP1CS8M1.js";import{e as f,u as k,a as R,b as A,c as Ce,f as Te,U as W}from"./zod-_sgmqnks.js";import{u as X}from"./useMutation-Cv5Pj69L.js";import{a as ke,D as Le,F as Ie}from"./file-text-5vL03K5q.js";import{U as M}from"./user-C54GR3IX.js";import{U as Y}from"./user-check-Cf6b-X0i.js";import{S as Se,T as De}from"./trash-2-BHh47ZHs.js";import{P as Oe}from"./plus-B6KoFE6S.js";/**
 * @license lucide-react v0.532.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Fe=f("funnel",Pe);/**
 * @license lucide-react v0.532.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Ae=f("mail",Re);/**
 * @license lucide-react v0.532.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=[["path",{d:"M5 12h14",key:"1ays0h"}]],qe=f("minus",Me);/**
 * @license lucide-react v0.532.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],Ue=f("phone",$e);/**
 * @license lucide-react v0.532.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Ge=f("search",_e);/**
 * @license lucide-react v0.532.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ze=f("triangle-alert",Qe),Ve=L({totalCost:b().min(0,"Total cost must be positive"),status:J(["PENDING","CONFIRMED","CANCELLED","COMPLETED","REFUNDED"]).optional(),orderLines:Ne(L({productId:b().min(1,"Please select a product"),productTypeId:b().optional(),quantity:b().min(0,"Quantity must be non-negative"),sessionId:b().optional()})).min(1,"At least one order line is required")}),Be=L({search:v().optional(),registrationType:J(["all","guest","member"]).default("all"),dateFrom:v().optional(),dateTo:v().optional()}),He=L({eventId:b().optional(),startDate:v().optional(),endDate:v().optional()}),We=q=>{const i={PENDING:{color:"bg-yellow-100 text-yellow-800",label:"Pending"},CONFIRMED:{color:"bg-blue-100 text-blue-800",label:"Confirmed"},CANCELLED:{color:"bg-red-100 text-red-800",label:"Cancelled"},COMPLETED:{color:"bg-green-100 text-green-800",label:"Completed"},REFUNDED:{color:"bg-gray-100 text-gray-800",label:"Refunded"}},w=i[q]||i.PENDING;return e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${w.color}`,children:w.label})},nt=function(){const{token:i,user:w}=Ee(),h=je(),[I,E]=n.useState(!1),[c,$]=n.useState(null),[U,S]=n.useState(!1),[K,C]=n.useState(!1),[x,_]=n.useState([]),[G,D]=n.useState(null),m=k(h.getOrders.queryOptions({authToken:i})),Z=k(h.getEvents.queryOptions({authToken:i})),p=k(h.getProducts.queryOptions({authToken:i})),d=k({...h.exportToExcel.queryOptions({authToken:i,exportType:"registrations",...G}),enabled:G!==null}),O=X(h.updateOrder.mutationOptions({onSuccess:()=>{g.success("Order updated successfully"),E(!1),$(null),se(),m.refetch()},onError:t=>{g.error(t.message||"Failed to update order")}})),ee=X(h.deleteOrder.mutationOptions({onSuccess:()=>{g.success("Order deleted successfully"),m.refetch()},onError:t=>{g.error(t.message||"Failed to delete order")}})),{register:y,handleSubmit:te,formState:{errors:u},reset:se,setValue:j,control:Q}=R({resolver:A(Ve)}),{fields:re,append:ae,remove:le,replace:de}=Ce({control:Q,name:"orderLines"}),l=Te({control:Q,name:"orderLines"}),{register:T,handleSubmit:Xe,watch:z,reset:V}=R({resolver:A(Be),defaultValues:{registrationType:"all"}}),{register:P,handleSubmit:ne,formState:{errors:Ye}}=R({resolver:A(He)}),F=n.useCallback(()=>!l||!p.data?0:l.reduce((t,s)=>{if(s.quantity>0&&s.productTypeId){const a=p.data?.find(o=>o.id===s.productId)?.productTypes.find(o=>o.id===s.productTypeId);if(a)return t+a.productPrice*s.quantity}return t},0),[l,p.data]);n.useEffect(()=>{if(I&&c){const t=F();j("totalCost",t)}},[l,I,c,F,j]),n.useEffect(()=>{if(d.isSuccess&&d.data){const t=d.data,s=[t.headers.join(","),...t.data.map(fe=>fe.map(ye=>`"${ye}"`).join(","))].join(`
`),r=new Blob([s],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),o=URL.createObjectURL(r);a.setAttribute("href",o),a.setAttribute("download",`registrations_export_${new Date().toISOString().split("T")[0]}.csv`),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a),g.success("Registration export completed successfully"),C(!1),D(null)}d.isError&&(g.error(d.error?.message||"Export failed"),D(null))},[d.isSuccess,d.isError,d.data,d.error]),n.useEffect(()=>{if(!m.data){_([]);return}let t=[...m.data];const s=z();if(s.search){const r=s.search.toLowerCase();t=t.filter(a=>a.guest?.guestName?.toLowerCase().includes(r)||a.member?.memberName?.toLowerCase().includes(r)||a.guest?.guestEmail?.toLowerCase().includes(r)||a.member?.memberEmail?.toLowerCase().includes(r)||a.transactionId.toLowerCase().includes(r))}if(s.registrationType==="guest"?t=t.filter(r=>r.guest):s.registrationType==="member"&&(t=t.filter(r=>r.member&&!r.guest)),s.dateFrom){const r=new Date(s.dateFrom);t=t.filter(a=>new Date(a.createdAt)>=r)}if(s.dateTo){const r=new Date(s.dateTo);r.setHours(23,59,59,999),t=t.filter(a=>new Date(a.createdAt)<=r)}_(t)},[m.data,z()]);const ie=async t=>{D(t)};if(w?.role!=="ADMIN")return e.jsx(B,{children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-red-600",children:"Access Denied"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"You don't have permission to access this page."})]})});const oe=t=>{$(t),j("totalCost",t.totalCost),j("status",t.status||"PENDING");const s=t.orderLines.map(r=>({productId:r.productId,productTypeId:r.productTypeId||void 0,quantity:r.quantity,sessionId:r.sessionId||void 0}));de(s),E(!0)},ce=async t=>{try{await O.mutateAsync({authToken:i,orderId:c.id,orderLines:t.orderLines,status:t.status})}catch{}},me=async t=>{window.confirm("Are you sure you want to delete this order? This action cannot be undone.")&&await ee.mutateAsync({authToken:i,orderId:t})},ue=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),N=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t),xe=x.length,he=x.filter(t=>t.guest).length,pe=x.filter(t=>t.member&&!t.guest).length,ge=x.reduce((t,s)=>t+s.totalCost,0),be=x.reduce((t,s)=>{const r=s.guest,a=s.member;return r?t+(r.adults||0)+(r.children||0)+(r.infants||0)+(r.elder||0):a?t+(a.adults||0)+(a.children||0)+(a.infants||0)+(a.elder||0):t},0);return e.jsx(B,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Registration Management"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:()=>S(!U),className:"flex items-center px-3 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:[e.jsx(Fe,{className:"h-4 w-4 mr-2"}),"Filters"]}),e.jsxs("button",{onClick:()=>C(!0),className:"flex items-center px-3 py-2 bg-green-600 text-white rounded-md text-sm font-medium hover:bg-green-700",children:[e.jsx(ke,{className:"h-4 w-4 mr-2"}),"Export"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(W,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Registrations"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:xe})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(M,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Guest | Member"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[he," | ",pe]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Y,{className:"h-8 w-8 text-purple-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total People"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:be})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Le,{className:"h-8 w-8 text-red-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Revenue"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:N(ge)})]})]})})]}),U&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Filter Registrations"}),e.jsx("button",{onClick:()=>{V(),S(!1)},className:"text-sm text-gray-500 hover:text-gray-700",children:"Clear Filters"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Search"}),e.jsxs("div",{className:"mt-1 relative",children:[e.jsx(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{...T("search"),type:"text",placeholder:"Name, email, transaction ID...",className:"pl-10 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-red-500 focus:border-red-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Registration Type"}),e.jsxs("select",{...T("registrationType"),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-red-500 focus:border-red-500",children:[e.jsx("option",{value:"all",children:"All Registrations"}),e.jsx("option",{value:"guest",children:"Guest Only"}),e.jsx("option",{value:"member",children:"Member Only"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"From Date"}),e.jsx("input",{...T("dateFrom"),type:"date",className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-red-500 focus:border-red-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"To Date"}),e.jsx("input",{...T("dateTo"),type:"date",className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-red-500 focus:border-red-500"})]})]})]}),m.isLoading?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-red-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Loading registrations..."})]}):x.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(W,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:m.data?.length===0?"No registrations found":"No registrations match your filters"}),m.data?.length!==0&&e.jsx("button",{onClick:()=>{V(),S(!1)},className:"mt-2 text-red-600 hover:text-red-700 text-sm",children:"Clear filters to show all registrations"})]}):e.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:e.jsx("ul",{className:"divide-y divide-gray-200",children:x.map(t=>e.jsx("li",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center",children:[t.guest?e.jsxs("div",{className:"flex items-center",children:[e.jsx(M,{className:"h-5 w-5 text-blue-600 mr-2"}),e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 mr-3",children:"Guest Registration"})]}):e.jsxs("div",{className:"flex items-center",children:[e.jsx(Y,{className:"h-5 w-5 text-green-600 mr-2"}),e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 mr-3",children:"Member Registration"})]}),e.jsxs("span",{className:"text-sm text-gray-500",children:["#",t.id]}),t.status&&e.jsx("div",{className:"ml-2",children:We(t.status)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:N(t.totalCost)}),e.jsx("p",{className:"text-xs text-gray-500",children:ue(t.createdAt)})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Contact Information"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),t.guest?.guestName||t.member?.memberName||"Unknown"]}),(t.guest?.guestEmail||t.member?.memberEmail)&&e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),t.guest?.guestEmail||t.member?.memberEmail]}),(t.guest?.guestPhone||t.member?.memberPhone)&&e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),t.guest?.guestPhone||t.member?.memberPhone]}),t.guest?.guestLocation&&e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(ve,{className:"h-4 w-4 mr-2"}),t.guest.guestLocation]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Family Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm text-gray-600",children:[e.jsxs("div",{children:["Adults: ",t.guest?.adults||t.member?.adults||0]}),e.jsxs("div",{children:["Children: ",t.guest?.children||t.member?.children||0]}),e.jsxs("div",{children:["Infants: ",t.guest?.infants||t.member?.infants||0]}),e.jsxs("div",{children:["Elders: ",t.guest?.elder||t.member?.elder||0]})]}),e.jsxs("div",{className:"mt-1 text-sm font-medium text-gray-900",children:["Total: ",(t.guest?.adults||t.member?.adults||0)+(t.guest?.children||t.member?.children||0)+(t.guest?.infants||t.member?.infants||0)+(t.guest?.elder||t.member?.elder||0)," people"]})]})]}),e.jsxs("div",{className:"flex items-center text-xs text-gray-500 space-x-4 mb-3",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(Ie,{className:"h-3 w-3 mr-1"}),"Transaction: ",t.transactionId]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(we,{className:"h-3 w-3 mr-1"}),t.orderLines.length," items"]})]}),e.jsx("div",{children:e.jsxs("details",{className:"text-sm text-gray-600",children:[e.jsxs("summary",{className:"cursor-pointer hover:text-gray-800 font-medium",children:["View Registration Details (",t.orderLines.length," items)"]}),e.jsx("div",{className:"mt-2 ml-4 space-y-2 bg-gray-50 p-3 rounded",children:t.orderLines.map((s,r)=>e.jsxs("div",{className:"flex justify-between items-center py-1 border-b border-gray-200 last:border-b-0",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"font-medium",children:s.product.productName}),s.productType&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s.productType.productSize," •",s.productType.productChoice!=="NONE"&&` ${s.productType.productChoice} •`,s.productType.productPref!=="NONE"&&` ${s.productType.productPref} •`,s.productType.productSubtype!=="NONE"&&` ${s.productType.productSubtype}`]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm",children:["Qty: ",s.quantity]}),s.productType&&e.jsx("div",{className:"text-sm font-medium",children:N(s.productType.productPrice*s.quantity)})]})]},r))})]})})]})})}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx("button",{onClick:()=>oe(t),className:"text-blue-600 hover:text-blue-900 p-2 rounded-md hover:bg-blue-50",title:"Edit Registration",children:e.jsx(Se,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>me(t.id),className:"text-red-600 hover:text-red-900 p-2 rounded-md hover:bg-red-50",title:"Delete Registration",children:e.jsx(De,{className:"h-4 w-4"})})]})]})},t.id))})}),I&&c&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsxs("div",{className:"relative top-20 mx-auto p-5 border w-full max-w-4xl shadow-lg rounded-md bg-white",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Edit Registration #",c.id]}),e.jsx("button",{onClick:()=>E(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(H,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ze,{className:"h-5 w-5 text-yellow-600 mr-2"}),e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Warning:"})," Editing orders may affect customer records. Use with caution."]})]})}),e.jsxs("form",{onSubmit:te(ce),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Customer"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-50 rounded-md text-sm text-gray-700",children:c.guest?.guestName||c.member?.memberName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Transaction ID"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-50 rounded-md text-sm text-gray-700",children:c.transactionId})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Order Status"}),e.jsxs("select",{...y("status"),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-red-500 focus:border-red-500",children:[e.jsx("option",{value:"PENDING",children:"Pending"}),e.jsx("option",{value:"CONFIRMED",children:"Confirmed"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"}),e.jsx("option",{value:"COMPLETED",children:"Completed"}),e.jsx("option",{value:"REFUNDED",children:"Refunded"})]}),u.status&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.status.message})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Order Items"}),e.jsxs("button",{type:"button",onClick:()=>ae({productId:0,productTypeId:void 0,quantity:1,sessionId:void 0}),className:"flex items-center px-2 py-1 text-xs bg-green-600 text-white rounded hover:bg-green-700",children:[e.jsx(Oe,{className:"h-3 w-3 mr-1"}),"Add Item"]})]}),e.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:re.map((t,s)=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Product"}),e.jsxs("select",{...y(`orderLines.${s}.productId`,{valueAsNumber:!0}),className:"block w-full text-sm border border-gray-300 rounded-md px-2 py-1 focus:outline-none focus:ring-red-500 focus:border-red-500",onChange:r=>{j(`orderLines.${s}.productTypeId`,void 0)},children:[e.jsx("option",{value:0,children:"Select a product..."}),p.data?.map(r=>e.jsxs("option",{value:r.id,children:[r.productName," (",r.productType,")"]},r.id))]}),u.orderLines?.[s]?.productId&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:u.orderLines[s]?.productId?.message})]}),l?.[s]?.productId&&l[s].productId>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Product Type"}),e.jsxs("select",{...y(`orderLines.${s}.productTypeId`,{valueAsNumber:!0}),className:"block w-full text-sm border border-gray-300 rounded-md px-2 py-1 focus:outline-none focus:ring-red-500 focus:border-red-500",children:[e.jsx("option",{value:"",children:"Select type..."}),p.data?.find(r=>r.id===l[s].productId)?.productTypes.map(r=>e.jsxs("option",{value:r.id,children:[r.productSize,r.productChoice!=="NONE"&&` - ${r.productChoice}`,r.productPref!=="NONE"&&` - ${r.productPref}`,r.productSubtype!=="NONE"&&` (${r.productSubtype})`," - $"+r.productPrice.toFixed(2)]},r.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Quantity"}),e.jsx("input",{...y(`orderLines.${s}.quantity`,{valueAsNumber:!0}),type:"number",min:"0",className:"block w-full text-sm border border-gray-300 rounded-md px-2 py-1 focus:outline-none focus:ring-red-500 focus:border-red-500"}),u.orderLines?.[s]?.quantity&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:u.orderLines[s]?.quantity?.message})]}),l?.[s]?.productTypeId&&l[s].quantity>0&&e.jsxs("div",{className:"text-xs text-gray-600",children:["Line Total: ",N((()=>{const a=p.data?.find(o=>o.id===l[s].productId)?.productTypes.find(o=>o.id===l[s].productTypeId);return a?a.productPrice*l[s].quantity:0})())]})]}),e.jsx("button",{type:"button",onClick:()=>le(s),className:"flex-shrink-0 p-1 text-red-600 hover:text-red-800 hover:bg-red-50 rounded",title:"Remove this item",children:e.jsx(qe,{className:"h-4 w-4"})})]})},t.id))}),u.orderLines&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.orderLines.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Total Cost"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-50 rounded-md text-lg font-semibold text-gray-900",children:N(F())}),e.jsx("input",{...y("totalCost",{valueAsNumber:!0}),type:"hidden"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>E(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:O.isPending,className:"px-4 py-2 bg-red-600 border border-transparent rounded-md text-sm font-medium text-white hover:bg-red-700 disabled:opacity-50",children:O.isPending?"Updating...":"Update Order"})]})]})]})}),K&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsxs("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Export Registrations"}),e.jsx("button",{onClick:()=>C(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(H,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:ne(ie),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Filter by Event"}),e.jsxs("select",{...P("eventId",{valueAsNumber:!0}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-red-500 focus:border-red-500",children:[e.jsx("option",{value:"",children:"All Events"}),Z.data?.map(t=>e.jsx("option",{value:t.id,children:t.eventName},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Start Date"}),e.jsx("input",{...P("startDate"),type:"date",className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-red-500 focus:border-red-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"End Date"}),e.jsx("input",{...P("endDate"),type:"date",className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-red-500 focus:border-red-500"})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Export includes:"})," Registration details, contact information, family details, session information, product selections, and pricing data."]})}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>C(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:d.isLoading,className:"px-4 py-2 bg-green-600 border border-transparent rounded-md text-sm font-medium text-white hover:bg-green-700 disabled:opacity-50",children:d.isLoading?"Exporting...":"Export to CSV"})]})]})]})})]})})};export{nt as component};
