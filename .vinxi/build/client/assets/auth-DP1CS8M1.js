import{R as b}from"./index-BzBvWqhX.js";const k=t=>{let r;const e=new Set,o=(i,g)=>{const h=typeof i=="function"?i(r):i;if(!Object.is(h,r)){const v=r;r=g??(typeof h!="object"||h===null)?h:Object.assign({},r,h),e.forEach(m=>m(r,v))}},a=()=>r,c={setState:o,getState:a,getInitialState:()=>d,subscribe:i=>(e.add(i),()=>e.delete(i))},d=r=t(o,a,c);return c},O=t=>t?k(t):k,R=t=>t;function j(t,r=R){const e=b.useSyncExternalStore(t.subscribe,b.useCallback(()=>r(t.getState()),[t,r]),b.useCallback(()=>r(t.getInitialState()),[t,r]));return b.useDebugValue(e),e}const A=t=>{const r=O(t),e=o=>j(r,o);return Object.assign(e,r),e},w=t=>t?A(t):A;function E(t,r){let e;try{e=t()}catch{return}return{getItem:a=>{var s;const f=d=>d===null?null:JSON.parse(d,void 0),c=(s=e.getItem(a))!=null?s:null;return c instanceof Promise?c.then(f):f(c)},setItem:(a,s)=>e.setItem(a,JSON.stringify(s,void 0)),removeItem:a=>e.removeItem(a)}}const p=t=>r=>{try{const e=t(r);return e instanceof Promise?e:{then(o){return p(o)(e)},catch(o){return this}}}catch(e){return{then(o){return this},catch(o){return p(o)(e)}}}},x=(t,r)=>(e,o,a)=>{let s={storage:E(()=>localStorage),partialize:n=>n,version:0,merge:(n,S)=>({...S,...n}),...r},f=!1;const c=new Set,d=new Set;let i=s.storage;if(!i)return t((...n)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),e(...n)},o,a);const g=()=>{const n=s.partialize({...o()});return i.setItem(s.name,{state:n,version:s.version})},h=a.setState;a.setState=(n,S)=>{h(n,S),g()};const v=t((...n)=>{e(...n),g()},o,a);a.getInitialState=()=>v;let m;const _=()=>{var n,S;if(!i)return;f=!1,c.forEach(u=>{var l;return u((l=o())!=null?l:v)});const y=((S=s.onRehydrateStorage)==null?void 0:S.call(s,(n=o())!=null?n:v))||void 0;return p(i.getItem.bind(i))(s.name).then(u=>{if(u)if(typeof u.version=="number"&&u.version!==s.version){if(s.migrate){const l=s.migrate(u.state,u.version);return l instanceof Promise?l.then(I=>[!0,I]):[!0,l]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,u.state];return[!1,void 0]}).then(u=>{var l;const[I,H]=u;if(m=s.merge(H,(l=o())!=null?l:v),e(m,!0),I)return g()}).then(()=>{y?.(m,void 0),m=o(),f=!0,d.forEach(u=>u(m))}).catch(u=>{y?.(void 0,u)})};return a.persist={setOptions:n=>{s={...s,...n},n.storage&&(i=n.storage)},clearStorage:()=>{i?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>_(),hasHydrated:()=>f,onHydrate:n=>(c.add(n),()=>{c.delete(n)}),onFinishHydration:n=>(d.add(n),()=>{d.delete(n)})},s.skipHydration||_(),m||v},C=x,J=w()(C(t=>({token:null,user:null,isAuthenticated:!1,setAuth:(r,e)=>t({token:r,user:e,isAuthenticated:!0}),clearAuth:()=>t({token:null,user:null,isAuthenticated:!1})}),{name:"auth-storage"}));export{J as u};
