import{u as L,r as j,a as C,o as k,j as e,s as n,n as i,V as m}from"./index-BzBvWqhX.js";import{u as R}from"./auth-DP1CS8M1.js";import{L as M}from"./Layout-DHUNYKTw.js";import{u as T,a as N,b as v}from"./zod-_sgmqnks.js";import{u as w}from"./useMutation-Cv5Pj69L.js";const I=k({email:n().email("Invalid email address"),password:n().min(1,"Password is required")}),q=k({memberName:n().min(1,"Name is required"),memberEmail:n().email("Invalid email address"),memberPhone:n().optional(),adults:i().min(1,"At least 1 adult required"),children:i().min(0),infants:i().min(0),elder:i().min(0),password:n().min(6,"Password must be at least 6 characters")}),W=function(){const{isAuthenticated:l,user:a,setAuth:b,token:f}=R(),c=L(),[o,S]=j.useState(!0),u=C(),x=w(u.login.mutationOptions()),p=w(u.register.mutationOptions()),h=T(u.getRegistrationCount.queryOptions({authToken:f},{enabled:l&&!!f})),{register:y,handleSubmit:E,formState:{errors:d}}=N({resolver:v(I)}),{register:t,handleSubmit:P,formState:{errors:s}}=N({resolver:v(q),defaultValues:{adults:1,children:0,infants:0,elder:0}});j.useEffect(()=>{l&&a&&(a.role==="ADMIN"?c({to:"/admin/users"}):c({to:"/admin/events"}))},[l,a,c]);const A=async g=>{try{const r=await x.mutateAsync(g);b(r.token,r.user),m.success("Login successful!")}catch(r){m.error(r.message||"Login failed")}},F=async g=>{try{const r=await p.mutateAsync(g);b(r.token,r.user),m.success("Registration successful!")}catch(r){m.error(r.message||"Registration failed")}};return l&&a?e.jsx(M,{children:e.jsxs("div",{className:"text-center space-y-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:["Welcome, ",a.member?.memberName||a.email,"!"]}),e.jsx("p",{className:"text-gray-600",children:"Use the navigation menu to access different features."}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6 max-w-sm mx-auto",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Total Registrations"}),h.isLoading?e.jsx("div",{className:"text-2xl font-bold text-gray-400",children:"Loading..."}):h.error?e.jsx("div",{className:"text-2xl font-bold text-red-600",children:"Error"}):e.jsx("div",{className:"text-3xl font-bold text-red-600",children:h.data?.count||0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Active registrations in system"})]})})})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("img",{src:"/mrittika.png",alt:"Mrittika Canada Logo",className:"h-20 w-auto"})}),e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Event Management System"}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:o?"Sign in to your account":"Create a new member account"})]}),e.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:e.jsxs("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:[o?e.jsxs("form",{onSubmit:E(A),className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),e.jsxs("div",{className:"mt-1",children:[e.jsx("input",{...y("email"),type:"email",className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-red-500 focus:border-red-500"}),d.email&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.email.message})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),e.jsxs("div",{className:"mt-1",children:[e.jsx("input",{...y("password"),type:"password",className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-red-500 focus:border-red-500"}),d.password&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.password.message})]})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:x.isPending,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50",children:x.isPending?"Signing in...":"Sign in"})})]}):e.jsxs("form",{onSubmit:P(F),className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"memberName",className:"block text-sm font-medium text-gray-700",children:"Full Name"}),e.jsxs("div",{className:"mt-1",children:[e.jsx("input",{...t("memberName"),type:"text",className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-red-500 focus:border-red-500"}),s.memberName&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:s.memberName.message})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"memberEmail",className:"block text-sm font-medium text-gray-700",children:"Email address"}),e.jsxs("div",{className:"mt-1",children:[e.jsx("input",{...t("memberEmail"),type:"email",className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-red-500 focus:border-red-500"}),s.memberEmail&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:s.memberEmail.message})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"memberPhone",className:"block text-sm font-medium text-gray-700",children:"Phone Number (Optional)"}),e.jsxs("div",{className:"mt-1",children:[e.jsx("input",{...t("memberPhone"),type:"tel",className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-red-500 focus:border-red-500"}),s.memberPhone&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:s.memberPhone.message})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Family Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"adults",className:"block text-sm font-medium text-gray-700",children:"Adults"}),e.jsx("input",{...t("adults",{valueAsNumber:!0}),type:"number",min:"1",className:"mt-1 appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-red-500 focus:border-red-500"}),s.adults&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:s.adults.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"children",className:"block text-sm font-medium text-gray-700",children:"Children (5-13)"}),e.jsx("input",{...t("children",{valueAsNumber:!0}),type:"number",min:"0",className:"mt-1 appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-red-500 focus:border-red-500"}),s.children&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:s.children.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"infants",className:"block text-sm font-medium text-gray-700",children:"Infants (0-5)"}),e.jsx("input",{...t("infants",{valueAsNumber:!0}),type:"number",min:"0",className:"mt-1 appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-red-500 focus:border-red-500"}),s.infants&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:s.infants.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"elder",className:"block text-sm font-medium text-gray-700",children:"Elders (60+)"}),e.jsx("input",{...t("elder",{valueAsNumber:!0}),type:"number",min:"0",className:"mt-1 appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-red-500 focus:border-red-500"}),s.elder&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:s.elder.message})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),e.jsxs("div",{className:"mt-1",children:[e.jsx("input",{...t("password"),type:"password",className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-red-500 focus:border-red-500"}),s.password&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:s.password.message})]})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:p.isPending,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50",children:p.isPending?"Creating account...":"Create account"})})]}),e.jsx("div",{className:"mt-6",children:e.jsx("div",{className:"text-center",children:e.jsx("button",{type:"button",onClick:()=>S(!o),className:"text-sm text-red-600 hover:text-red-500",children:o?"Don't have an account? Register here":"Already have an account? Sign in here"})})})]})})]})};export{W as component};
