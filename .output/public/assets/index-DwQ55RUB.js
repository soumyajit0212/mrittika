import{a as D,r as j,V as n,o as E,j as e,s as b,n as M}from"./index-BzBvWqhX.js";import{L as f,M as v,X as P}from"./Layout-DHUNYKTw.js";import{u as T}from"./auth-DP1CS8M1.js";import{u as O,a as F,b as L,U as q,C as U}from"./zod-_sgmqnks.js";import{u as y}from"./useMutation-Cv5Pj69L.js";import{P as I}from"./plus-B6KoFE6S.js";import{S as Q,T as R}from"./trash-2-BHh47ZHs.js";const z=E({venueAddress:b().min(1,"Address is required"),venueCapacity:M().min(1,"Capacity must be at least 1"),venueDetails:b().optional()}),Z=function(){const{token:d,user:N}=T(),l=D(),[w,t]=j.useState(!1),[i,c]=j.useState(null),a=O(l.getVenues.queryOptions({authToken:d})),o=y(l.createVenue.mutationOptions({onSuccess:()=>{n.success("Venue created successfully"),t(!1),x(),a.refetch()},onError:s=>{n.error(s.message||"Failed to create venue")}})),m=y(l.updateVenue.mutationOptions({onSuccess:()=>{n.success("Venue updated successfully"),t(!1),c(null),x(),a.refetch()},onError:s=>{n.error(s.message||"Failed to update venue")}})),C=y(l.deleteVenue.mutationOptions({onSuccess:()=>{n.success("Venue deleted successfully"),a.refetch()},onError:s=>{n.error(s.message||"Failed to delete venue")}})),{register:u,handleSubmit:V,formState:{errors:r},reset:x,setValue:h}=F({resolver:L(z)});if(!N||!d)return e.jsx(f,{children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-red-600",children:"Access Denied"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Please log in to access this page."})]})});const g=()=>{c(null),x(),t(!0)},A=s=>{c(s),h("venueAddress",s.venueAddress),h("venueCapacity",s.venueCapacity),h("venueDetails",s.venueDetails||""),t(!0)},k=async s=>{try{i?await m.mutateAsync({authToken:d,venueId:i.id,...s}):await o.mutateAsync({authToken:d,...s})}catch{}},S=async s=>{window.confirm("Are you sure you want to delete this venue? This will also delete all associated events.")&&await C.mutateAsync({authToken:d,venueId:s})};return e.jsx(f,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Venue Management"}),e.jsxs("button",{onClick:g,className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-md flex items-center",children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Add Venue"]})]}),a.isLoading?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-red-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Loading venues..."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.data?.map(s=>e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(v,{className:"h-5 w-5 text-red-600 mr-2"}),e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Venue #",s.id]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>A(s),className:"text-blue-600 hover:text-blue-900",children:e.jsx(Q,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>S(s.id),className:"text-red-600 hover:text-red-900",children:e.jsx(R,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Address:"}),e.jsx("p",{className:"text-sm text-gray-600",children:s.venueAddress})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(q,{className:"h-4 w-4 text-gray-400 mr-2"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Capacity: ",s.venueCapacity]})]}),s.venueDetails&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Details:"}),e.jsx("p",{className:"text-sm text-gray-600",children:s.venueDetails})]}),s.events&&s.events.length>0&&e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-gray-700 mb-2 flex items-center",children:[e.jsx(U,{className:"h-4 w-4 mr-1"}),"Events (",s.events.length,"):"]}),e.jsxs("div",{className:"space-y-1",children:[s.events.slice(0,3).map(p=>e.jsxs("p",{className:"text-xs text-gray-500",children:["â€¢ ",p.eventName]},p.id)),s.events.length>3&&e.jsxs("p",{className:"text-xs text-gray-400",children:["... and ",s.events.length-3," more"]})]})]})]})]},s.id))}),a.data?.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(v,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No venues found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Get started by creating your first venue."}),e.jsx("button",{onClick:g,className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-md",children:"Add Venue"})]}),w&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsxs("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:i?"Edit Venue":"Create Venue"}),e.jsx("button",{onClick:()=>t(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(P,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:V(k),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Address *"}),e.jsx("textarea",{...u("venueAddress"),rows:3,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-red-500 focus:border-red-500",placeholder:"Enter venue address..."}),r.venueAddress&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.venueAddress.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Capacity *"}),e.jsx("input",{...u("venueCapacity",{valueAsNumber:!0}),type:"number",min:"1",className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-red-500 focus:border-red-500",placeholder:"Enter maximum capacity..."}),r.venueCapacity&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.venueCapacity.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Details"}),e.jsx("textarea",{...u("venueDetails"),rows:3,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-red-500 focus:border-red-500",placeholder:"Enter additional venue details..."}),r.venueDetails&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.venueDetails.message})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>t(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:o.isPending||m.isPending,className:"px-4 py-2 bg-red-600 border border-transparent rounded-md text-sm font-medium text-white hover:bg-red-700 disabled:opacity-50",children:o.isPending||m.isPending?"Saving...":i?"Update":"Create"})]})]})]})})]})})};export{Z as component};
